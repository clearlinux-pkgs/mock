From 8cf96be57bf67077eff9362ad29064fa5fd1712a Mon Sep 17 00:00:00 2001
From: William Douglas <william.douglas@intel.com>
Date: Tue, 23 May 2023 12:00:00 -0700
Subject: [PATCH] Disable bootstrap by default

We do not want to enable this feature yet, so make sure it is disabled
out of the box.

Signed-off-by: Patrick McCarty <patrick.mccarty@intel.com>
---
 docs/site-defaults.cfg | 3 ++-
 py/mock.py             | 2 +-
 py/mockbuild/config.py | 2 +-
 3 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/docs/site-defaults.cfg b/docs/site-defaults.cfg
index 9a9c427..378f2ea 100644
--- a/docs/site-defaults.cfg
+++ b/docs/site-defaults.cfg
@@ -129,7 +129,8 @@
 # Therefore, with `use_bootstrap=True` default, we first install a minimal
 # "bootstrap" chroot that only contains rpm/yum/dnf stack, and from that
 # "bootstrap" chroot we initialize the target chroot.
-#config_opts['use_bootstrap'] = True
+# NOTE: In Clear Linux OS, the default value is False.
+#config_opts['use_bootstrap'] = False
 
 #config_opts['system_yum_command'] = '/usr/bin/yum'
 #config_opts['system_dnf_command'] = '/usr/bin/dnf'
diff --git a/py/mock.py b/py/mock.py
index 75f50e5..9ef8719 100755
--- a/py/mock.py
+++ b/py/mock.py
@@ -727,7 +727,7 @@ def main():
 
     # When scrubbing all, we also want to scrub a bootstrap chroot
     if options.scrub:
-        config_opts['use_bootstrap'] = True
+        config_opts['use_bootstrap'] = False
 
     # outer buildroot to bootstrap the installation - based on main config with some differences
     bootstrap_buildroot = None
diff --git a/py/mockbuild/config.py b/py/mockbuild/config.py
index 262d36e..d6f77e3 100644
--- a/py/mockbuild/config.py
+++ b/py/mockbuild/config.py
@@ -76,7 +76,7 @@ def setup_default_config_opts():
     config_opts['nspawn_args'] = ['--capability=cap_ipc_lock']
     config_opts['use_container_host_hostname'] = True
 
-    config_opts['use_bootstrap'] = True
+    config_opts['use_bootstrap'] = False
     config_opts['use_bootstrap_image'] = False
     config_opts['bootstrap_image'] = 'fedora:latest'
 
-- 
2.40.1

