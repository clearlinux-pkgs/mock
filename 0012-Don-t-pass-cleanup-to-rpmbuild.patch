From 262beafd64923fd6db2e1aedc8eba3c3b82f87d3 Mon Sep 17 00:00:00 2001
From: William Douglas <william.douglas@intel.com>
Date: Tue, 23 May 2023 12:11:36 -0700
Subject: [PATCH] Don't pass cleanup to rpmbuild

This breaks autospec and the common tooling.

Signed-off-by: William Douglas <william.douglas@intel.com>
---
 py/mockbuild/backend.py | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/py/mockbuild/backend.py b/py/mockbuild/backend.py
index 37bd401..5b0fb2b 100644
--- a/py/mockbuild/backend.py
+++ b/py/mockbuild/backend.py
@@ -689,8 +689,8 @@ class Commands(object):
 
     @traceLog()
     def rebuild_installed_srpm(self, spec_path, timeout):
-        command = ['{command} -bs {0} --target {1} --nodeps {2}'.format(
-            self._rpmbuild_noclean_option, self.rpmbuild_arch, spec_path,
+        command = ['{command} -bs --target {0} --nodeps {1}'.format(
+            self.rpmbuild_arch, spec_path,
             command=self.config['rpmbuild_command'])]
         command = ["bash", "--login", "-c"] + command
         self.buildroot.doChroot(
@@ -734,7 +734,6 @@ class Commands(object):
 
         def get_command(mode):
             command = [self.config['rpmbuild_command']] + mode + \
-                      [self._rpmbuild_noclean_option] + \
                       ['--target', self.rpmbuild_arch, '--nodeps'] + \
                       check_opt + [spec_path] + additional_opts
             command = ["bash", "--login", "-c"] + [' '.join(command)]
-- 
2.40.1

